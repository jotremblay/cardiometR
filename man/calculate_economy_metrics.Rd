% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/methods-economy.R
\name{calculate_economy_metrics}
\alias{calculate_economy_metrics}
\title{Calculate Economy Metrics for Analysis}
\usage{
calculate_economy_metrics(analysis, reference_stage, speed_kmh = NULL)
}
\arguments{
\item{analysis}{CpetAnalysis object with stage_summary populated}

\item{reference_stage}{Stage number to use for economy calculations}

\item{speed_kmh}{For treadmill tests, the speed at the reference stage in km/h.
If NULL and stage_summary has a speed column, that will be used.}
}
\value{
An EconomyMetrics S7 object
}
\description{
Wrapper function to calculate all economy/efficiency metrics for a CpetAnalysis
object at a user-specified reference stage.
}
\details{
For cycling tests: Calculates gross efficiency using power and VO2 at the
reference stage.

For treadmill tests: Calculates running economy using VO2/kg and speed at
the reference stage.

The modality is automatically detected from the analysis protocol metadata.
}
\examples{
\dontrun{
# Calculate efficiency at stage 4
economy <- calculate_economy_metrics(analysis, reference_stage = 4)

# For treadmill with known speed
economy <- calculate_economy_metrics(analysis, reference_stage = 3, speed_kmh = 12)
}

}
